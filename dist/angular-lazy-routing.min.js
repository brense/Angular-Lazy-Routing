var ngLazyRouting=angular.module("ngLazyRouting",["ngRoute"]);ngLazyRouting.config(["$provide","$controllerProvider","$routeProvider",function(a,b,c){ngLazyRouting.register={controller:b.register},a.factory("$routeProvider",function(){return c})}]),ngLazyRouting.run(["$routeProvider","$routingConfig","RoutingService",function(a,b,c){if("undefined"==typeof b.callback)throw new Error("Please provide a route callback function using setRouteCallback");var d=["/","/:page*"];if("undefined"!=typeof b.routes)var d=b.routes;for(var e in d)a.when(d[e],{template:'<div ng-include="templateUrl"></div>',resolve:{load:c.route}});a.otherwise({redirectTo:"/"})}]),ngLazyRouting.provider("$routingConfig",function(){this.error={},this.setRoutes=function(a){return this.routes=a,this},this.setErrorTemplate=function(a,b){return this.error[a]=b,this},this.setRouteCallback=function(a){return this.callback=a,this},this.$get=function(){return this}}),ngLazyRouting.service("RoutingService",["$rootScope","$q","$templateCache","$route","$routingConfig",function(a,b,c,d,e){var f=this,g={},h={401:{name:"unauthorized",template:"<div>401 Unauthorized</div>"},403:{name:"forbidden",template:"<div>403 Forbidden</div>"},404:{name:"notfound",template:"<div>404 Not Found</div>"}};this.route=function(){var a=b.defer(),c=d.current.originalPath;if("undefined"!=typeof d.current.pathParams.page&&(c=d.current.pathParams.page),"undefined"==typeof g[c]){var h=angular.injector(["ng"]);h.instantiate(e.callback,{path:0===c.indexOf("/")?c:"/"+c}).then(function(b){g[c]=b,$script([b.controller.path],function(){f.applyRouteChange(c,b),a.resolve()})}).catch(function(b){f.handleErrors(b),a.resolve()})}else f.applyRouteChange(c,g[c]),a.resolve();return a.promise},this.handleErrors=function(b){if(a.$broadcast("routing error",b),"undefined"!=typeof h[b.status]){var d=h[b.status].name;"undefined"==typeof e.error[b.status]?c.put(h[b.status].name,h[b.status].template):/<[a-z][\s\S]*>/i.test(e.error[b.status])?c.put(h[b.status].name,e.error[b.status]):d=e.error[b.status],a.templateUrl=d}},this.applyRouteChange=function(b,e){c.put(b,e.template),a.templateUrl=b,d.current.controller=e.controller.name}}]);